define("wixCodeInit/utils/urlBuilder",[],function(){"use strict";function a(){for(var a=arguments[0],b=1;b<arguments.length;++b)a=a.replace(/\/$/,"")+"/"+arguments[b].replace(/^\//,"");return a}function b(a){return/^https?:\/\/localhost\/?$/.test(a)}function c(a){return/^\d+\.\d+\.\d+$/.test(a)}function d(a,b){var d=a.lastIndexOf("/");return c(b)?a.substring(0,d+1)+b:a}function e(a,c){var e=a.serviceTopology,f=b(a.santaBase)?e.scriptsLocationMap.santa:a.santaBase;return f=d(f,c),f.replace(e.scriptsDomainUrl,"")}function f(b,c,d,f){var g=c.extensionId,h="//"+g+".",i=b.serviceTopology.wixCloudBaseDomain,j=d?"index.debug.html":"index.html",k="static/wixcode/target/"+j,l=e(b,f);return h+a(i,"_static",l,k)}function g(a,b,c){c=c||{};var d=f(a,b,c.debug,c.runtimeSource),e=!!a.publicModel,g={compId:"wixCode_"+b.appDefinitionId,deviceType:c.isMobileView?"mobile":"desktop",viewMode:e?"site":a.renderFlags.componentViewMode||"preview",instance:b.instance,locale:a.rendererModel.languageCode,cacheKiller:(new Date).getTime().toString(),codeVersion:e?a.publicModel.siteRevision:"dev"};c.sdkSource&&(g.sdkSource=c.sdkSource);var h=Object.keys(g).map(function(a){return a+"="+g[a]}).join("&");return d+"?"+h}return{buildUrl:g}}),define("wixCodeInit/utils/messageHolder",[],function(){"use strict";function a(){var a=[],b=null;return{sendOrHoldMessage:function(c){b?b(c):a.push(c)},setMessageTarget:function(c){for(b=c;a.length>0;)b(a.shift())}}}return{get:a}}),define("wixCodeInit/utils/iFrameUtils",[],function(){"use strict";function a(a,b){"loading"!==document.readyState?a.appendChild(b):document.addEventListener("DOMContentLoaded",function(){a.appendChild(b)})}function b(a,b){var c=document.createElement("iframe");return c.style.display="none",c.src=a,c.className="wix-code-app",c.setAttribute("data-app-id",b.applicationId),c.setAttribute("data-app-definition-id",b.appDefinitionId),c}function c(a,b){return b.source===a.contentWindow}return{addToDOM:a,getIFrameForApp:b,isIFrameEvent:c}}),define("wixCodeInit",["wixCodeInit/utils/urlBuilder","wixCodeInit/utils/messageHolder","wixCodeInit/utils/iFrameUtils","experiment"],function(a,b,c,d){"use strict";function f(a){return"WIX_CODE"===a.intent&&"wix_code_iframe_loaded"===a.type}function g(a){for(var b in a)if(a.hasOwnProperty(b)&&a[b].type===e)return a[b]}function h(){function k(a,b){c.isIFrameEvent(a,b)&&(f(b.data)&&i.setMessageTarget(function(b){a.contentWindow.postMessage(b,"*")}),h.forEach(function(a){a(b.data)}))}function l(b,d,e){if(j)return void console.warn("Wix code is already initiated");var f=g(d);if(f){var h=a.buildUrl(b,f,e),i=c.getIFrameForApp(h,f),l=k.bind(null,i);window.addEventListener("message",l,!1),c.addToDOM(document.body,i),j=!0}}function m(a){h.push(a)}if(!d.isOpen("wixCodeBinding")){var e=function(){};return{init:e,sendMessage:e,registerMessageHandler:e}}var h=[],i=b.get(),j=!1;return{init:l,sendMessage:i.sendOrHoldMessage,registerMessageHandler:m}}function i(a,b,c,e,f){if(d.isOpen("wixCodeBinding")){var g={isMobileView:e,debug:f.getParameterByName("debug"),sdkSource:f.getParameterByName("sdkSource"),runtimeSource:f.getParameterByName("WixCodeRuntimeSource")},h=!!b.publicModel,i=h&&"success"!==b.dynamicModelState;i?c(function(c){a.init(b,c.clientSpecMap,g)},function(){console.error("Error fetching dynamic client spec map model")}):a.init(b,b.rendererModel.clientSpecMap,g)}}var e="siteextension";return{getAppApi:h,initMainR:i}});